DECLARE @job_loginVar varchar(60)
SET @job_loginVar = N'UPE-SRV\Administrator'
DECLARE @job_passwordVar varchar(60)
SET @job_passwordVar = N'!upem29'
DECLARE @subscriber_loginVar varchar(60)
SET @subscriber_loginVar = N'upedb'
DECLARE @subscriber_passwordVar varchar(60)
SET @subscriber_passwordVar = N'upem29'

-- Enabling the replication database
use master
exec sp_replicationdboption @dbname = N'UPE_MM2_Administration2', @optname = N'merge publish', @value = N'true'

-- Adding the merge publication
use [UPE_MM2_Administration2]
exec sp_addmergepublication @publication = N'UPE_MM2_Administration2_Publication', @description = N'Merge publication of database ''UPE_MM2_Administration2'' from Publisher ''UPE-SRV''.', @sync_mode = N'native', @retention = 14, @allow_push = N'true', @allow_pull = N'true', @allow_anonymous = N'true', @enabled_for_internet = N'false', @snapshot_in_defaultfolder = N'true', @compress_snapshot = N'false', @ftp_port = 21, @ftp_subdirectory = N'ftp', @ftp_login = N'anonymous', @allow_subscription_copy = N'false', @add_to_active_directory = N'false', @dynamic_filters = N'false', @conflict_retention = 14, @keep_partition_changes = N'false', @allow_synctoalternate = N'false', @max_concurrent_merge = 0, @max_concurrent_dynamic_snapshots = 0, @use_partition_groups = N'false', @publication_compatibility_level = N'100RTM', @replicate_ddl = 1, @allow_subscriber_initiated_snapshot = N'false', @allow_web_synchronization = N'false', @allow_partition_realignment = N'true', @retention_period_unit = N'days', @conflict_logging = N'both', @automatic_reinitialization_policy = 0

exec sp_addpublication_snapshot @publication = N'UPE_MM2_Administration2_Publication', @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 500, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0, @job_login = @job_loginVar, @job_password = @job_passwordVar, @publisher_security_mode = 1
exec sp_grant_publication_access @publication = N'UPE_MM2_Administration2_Publication', @login = N'sa'
exec sp_grant_publication_access @publication = N'UPE_MM2_Administration2_Publication', @login = @job_loginVar
exec sp_grant_publication_access @publication = N'UPE_MM2_Administration2_Publication', @login = N'NT SERVICE\Winmgmt'
exec sp_grant_publication_access @publication = N'UPE_MM2_Administration2_Publication', @login = N'NT SERVICE\SQLWriter'
exec sp_grant_publication_access @publication = N'UPE_MM2_Administration2_Publication', @login = N'NT SERVICE\SQLSERVERAGENT'
exec sp_grant_publication_access @publication = N'UPE_MM2_Administration2_Publication', @login = N'NT Service\MSSQLSERVER'
exec sp_grant_publication_access @publication = N'UPE_MM2_Administration2_Publication', @login = N'distributor_admin'

-- Adding the merge articles
use [UPE_MM2_Administration2]
exec sp_addmergearticle @publication = N'UPE_MM2_Administration2_Publication', @article = N'admActivity', @source_owner = N'dbo', @source_object = N'admActivity', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Administration2_Publication', @article = N'admActivityModule', @source_owner = N'dbo', @source_object = N'admActivityModule', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Administration2_Publication', @article = N'admActivityUsingHistory', @source_owner = N'dbo', @source_object = N'admActivityUsingHistory', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Administration2_Publication', @article = N'admAircraftAccess', @source_owner = N'dbo', @source_object = N'admAircraftAccess', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Administration2_Publication', @article = N'admRole', @source_owner = N'dbo', @source_object = N'admRole', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Administration2_Publication', @article = N'admRoleAccess', @source_owner = N'dbo', @source_object = N'admRoleAccess', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Administration2_Publication', @article = N'admSystemEventAccount', @source_owner = N'dbo', @source_object = N'admSystemEventAccount', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Administration2_Publication', @article = N'admUserAccess', @source_owner = N'dbo', @source_object = N'admUserAccess', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Administration2_Publication', @article = N'admUserInRole', @source_owner = N'dbo', @source_object = N'admUserInRole', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Administration2_Publication', @article = N'admUserLogs', @source_owner = N'dbo', @source_object = N'admUserLogs', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Administration2_Publication', @article = N'admUserPassword', @source_owner = N'dbo', @source_object = N'admUserPassword', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Administration2_Publication', @article = N'admVacancyRoles', @source_owner = N'dbo', @source_object = N'admVacancyRoles', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0

-- Adding the merge subscriptions
use [UPE_MM2_Administration2]
exec sp_addmergesubscription @publication = N'UPE_MM2_Administration2_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Administration2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Administration2_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Administration2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Administration2_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Administration2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Administration2_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Administration2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Administration2_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Administration2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Administration2_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Administration2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Administration2_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Administration2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Administration2_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Administration2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Administration2_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Administration2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Administration2_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Administration2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0

-- Enabling the replication database
use master
exec sp_replicationdboption @dbname = N'UPE_MM2_Catalog', @optname = N'merge publish', @value = N'true'

-- Adding the merge publication
use [UPE_MM2_Catalog]
exec sp_addmergepublication @publication = N'UPE_MM2_Catalog_Publication', @description = N'Merge publication of database ''UPE_MM2_Catalog'' from Publisher ''UPE-SRV''.', @sync_mode = N'native', @retention = 14, @allow_push = N'true', @allow_pull = N'true', @allow_anonymous = N'true', @enabled_for_internet = N'false', @snapshot_in_defaultfolder = N'true', @compress_snapshot = N'false', @ftp_port = 21, @ftp_subdirectory = N'ftp', @ftp_login = N'anonymous', @allow_subscription_copy = N'false', @add_to_active_directory = N'false', @dynamic_filters = N'false', @conflict_retention = 14, @keep_partition_changes = N'false', @allow_synctoalternate = N'false', @max_concurrent_merge = 0, @max_concurrent_dynamic_snapshots = 0, @use_partition_groups = N'false', @publication_compatibility_level = N'100RTM', @replicate_ddl = 1, @allow_subscriber_initiated_snapshot = N'false', @allow_web_synchronization = N'false', @allow_partition_realignment = N'true', @retention_period_unit = N'days', @conflict_logging = N'both', @automatic_reinitialization_policy = 0

exec sp_addpublication_snapshot @publication = N'UPE_MM2_Catalog_Publication', @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 500, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0, @job_login = @job_loginVar, @job_password = @job_passwordVar, @publisher_security_mode = 1
exec sp_grant_publication_access @publication = N'UPE_MM2_Catalog_Publication', @login = N'sa'
exec sp_grant_publication_access @publication = N'UPE_MM2_Catalog_Publication', @login = @job_loginVar
exec sp_grant_publication_access @publication = N'UPE_MM2_Catalog_Publication', @login = N'NT SERVICE\Winmgmt'
exec sp_grant_publication_access @publication = N'UPE_MM2_Catalog_Publication', @login = N'NT SERVICE\SQLWriter'
exec sp_grant_publication_access @publication = N'UPE_MM2_Catalog_Publication', @login = N'NT SERVICE\SQLSERVERAGENT'
exec sp_grant_publication_access @publication = N'UPE_MM2_Catalog_Publication', @login = N'NT Service\MSSQLSERVER'
exec sp_grant_publication_access @publication = N'UPE_MM2_Catalog_Publication', @login = N'distributor_admin'

-- Adding the merge articles
use [UPE_MM2_Catalog]
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'AccessForUser', @source_owner = N'dbo', @source_object = N'AccessForUser', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'AccessForUser2', @source_owner = N'dbo', @source_object = N'AccessForUser2', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'DemandHeaders', @source_owner = N'dbo', @source_object = N'DemandHeaders', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'DemandHistory', @source_owner = N'dbo', @source_object = N'DemandHistory', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'DemandLines', @source_owner = N'dbo', @source_object = N'DemandLines', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'DemandStatuses', @source_owner = N'dbo', @source_object = N'DemandStatuses', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'ExcludedNodes', @source_owner = N'dbo', @source_object = N'ExcludedNodes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'HA', @source_owner = N'dbo', @source_object = N'HA', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'HG', @source_owner = N'dbo', @source_object = N'HG', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'HJ', @source_owner = N'dbo', @source_object = N'HJ', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'HK', @source_owner = N'dbo', @source_object = N'HK', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'IllustrationByFinalItem', @source_owner = N'dbo', @source_object = N'IllustrationByFinalItem', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'IllustrationByNodes', @source_owner = N'dbo', @source_object = N'IllustrationByNodes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'IllustrationByProducts', @source_owner = N'dbo', @source_object = N'IllustrationByProducts', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'Illustrations', @source_owner = N'dbo', @source_object = N'Illustrations', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'ImageItemPos', @source_owner = N'dbo', @source_object = N'ImageItemPos', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'ImageItemPos2', @source_owner = N'dbo', @source_object = N'ImageItemPos2', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'Images', @source_owner = N'dbo', @source_object = N'Images', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'Images2', @source_owner = N'dbo', @source_object = N'Images2', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'Operations', @source_owner = N'dbo', @source_object = N'Operations', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'OperationsLog', @source_owner = N'dbo', @source_object = N'OperationsLog', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'ProductAttributes', @source_owner = N'dbo', @source_object = N'ProductAttributes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'ProductAttrValues', @source_owner = N'dbo', @source_object = N'ProductAttrValues', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'ProductTypes', @source_owner = N'dbo', @source_object = N'ProductTypes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'ServicePeriodicity', @source_owner = N'dbo', @source_object = N'ServicePeriodicity', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'SynchronizingLog', @source_owner = N'dbo', @source_object = N'SynchronizingLog', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'Tmp1', @source_owner = N'dbo', @source_object = N'Tmp1', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'TopDevice', @source_owner = N'dbo', @source_object = N'TopDevice', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'TreeNodes', @source_owner = N'dbo', @source_object = N'TreeNodes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'Variants', @source_owner = N'dbo', @source_object = N'Variants', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'XA', @source_owner = N'dbo', @source_object = N'XA', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'XAAdd', @source_owner = N'dbo', @source_object = N'XAAdd', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'XB', @source_owner = N'dbo', @source_object = N'XB', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'XB_tmp', @source_owner = N'dbo', @source_object = N'XB_tmp', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'XBAdd', @source_owner = N'dbo', @source_object = N'XBAdd', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Catalog_Publication', @article = N'XH', @source_owner = N'dbo', @source_object = N'XH', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0

-- Adding the merge subscriptions
use [UPE_MM2_Catalog]
exec sp_addmergesubscription @publication = N'UPE_MM2_Catalog_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Catalog', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Catalog_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Catalog', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Catalog_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Catalog', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Catalog_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Catalog', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Catalog_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Catalog', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Catalog_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Catalog', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Catalog_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Catalog', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Catalog_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Catalog', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Catalog_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Catalog', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Catalog_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Catalog', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0

-- Enabling the replication database
use master
exec sp_replicationdboption @dbname = N'UPE_MM2_Documents2', @optname = N'merge publish', @value = N'true'

-- Adding the merge publication
use [UPE_MM2_Documents2]
exec sp_addmergepublication @publication = N'UPE_MM2_Documents2_Publication', @description = N'Merge publication of database ''UPE_MM2_Documents2'' from Publisher ''UPE-SRV''.', @sync_mode = N'native', @retention = 14, @allow_push = N'true', @allow_pull = N'true', @allow_anonymous = N'true', @enabled_for_internet = N'false', @snapshot_in_defaultfolder = N'true', @compress_snapshot = N'false', @ftp_port = 21, @ftp_subdirectory = N'ftp', @ftp_login = N'anonymous', @allow_subscription_copy = N'false', @add_to_active_directory = N'false', @dynamic_filters = N'false', @conflict_retention = 14, @keep_partition_changes = N'false', @allow_synctoalternate = N'false', @max_concurrent_merge = 0, @max_concurrent_dynamic_snapshots = 0, @use_partition_groups = N'false', @publication_compatibility_level = N'100RTM', @replicate_ddl = 1, @allow_subscriber_initiated_snapshot = N'false', @allow_web_synchronization = N'false', @allow_partition_realignment = N'true', @retention_period_unit = N'days', @conflict_logging = N'both', @automatic_reinitialization_policy = 0

exec sp_addpublication_snapshot @publication = N'UPE_MM2_Documents2_Publication', @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 500, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0, @job_login = @job_loginVar, @job_password = @job_passwordVar, @publisher_security_mode = 1
exec sp_grant_publication_access @publication = N'UPE_MM2_Documents2_Publication', @login = N'sa'
exec sp_grant_publication_access @publication = N'UPE_MM2_Documents2_Publication', @login = @job_loginVar
exec sp_grant_publication_access @publication = N'UPE_MM2_Documents2_Publication', @login = N'NT SERVICE\Winmgmt'
exec sp_grant_publication_access @publication = N'UPE_MM2_Documents2_Publication', @login = N'NT SERVICE\SQLWriter'
exec sp_grant_publication_access @publication = N'UPE_MM2_Documents2_Publication', @login = N'NT SERVICE\SQLSERVERAGENT'
exec sp_grant_publication_access @publication = N'UPE_MM2_Documents2_Publication', @login = N'NT Service\MSSQLSERVER'
exec sp_grant_publication_access @publication = N'UPE_MM2_Documents2_Publication', @login = N'distributor_admin'

-- Adding the merge articles
use [UPE_MM2_Documents2]
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docBulletinAircrafts', @source_owner = N'dbo', @source_object = N'docBulletinAircrafts', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docBulletins', @source_owner = N'dbo', @source_object = N'docBulletins', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docChanges', @source_owner = N'dbo', @source_object = N'docChanges', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docDocTypes', @source_owner = N'dbo', @source_object = N'docDocTypes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docDocuments', @source_owner = N'dbo', @source_object = N'docDocuments', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docDocumentsMessages', @source_owner = N'dbo', @source_object = N'docDocumentsMessages', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docFileFile', @source_owner = N'dbo', @source_object = N'docFileFile', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docFiles', @source_owner = N'dbo', @source_object = N'docFiles', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docMesagesKinds', @source_owner = N'dbo', @source_object = N'docMesagesKinds', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docMessages', @source_owner = N'dbo', @source_object = N'docMessages', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docPriority', @source_owner = N'dbo', @source_object = N'docPriority', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docRenews', @source_owner = N'dbo', @source_object = N'docRenews', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docTreeElements', @source_owner = N'dbo', @source_object = N'docTreeElements', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Documents2_Publication', @article = N'docTreeElements_Documents', @source_owner = N'dbo', @source_object = N'docTreeElements_Documents', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0

-- Adding the merge subscriptions
use [UPE_MM2_Documents2]
exec sp_addmergesubscription @publication = N'UPE_MM2_Documents2_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Documents2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Documents2_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Documents2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Documents2_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Documents2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Documents2_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Documents2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Documents2_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Documents2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Documents2_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Documents2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Documents2_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Documents2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Documents2_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Documents2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Documents2_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Documents2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Documents2_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Documents2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0

-- Enabling the replication database
use master
exec sp_replicationdboption @dbname = N'UPE_MM2_Formular', @optname = N'merge publish', @value = N'true'

-- Adding the merge publication
use [UPE_MM2_Formular]
exec sp_addmergepublication @publication = N'UPE_MM2_Formular_Publication', @description = N'Merge publication of database ''UPE_MM2_Formular'' from Publisher ''UPE-SRV''.', @sync_mode = N'native', @retention = 14, @allow_push = N'true', @allow_pull = N'true', @allow_anonymous = N'true', @enabled_for_internet = N'false', @snapshot_in_defaultfolder = N'true', @compress_snapshot = N'false', @ftp_port = 21, @ftp_subdirectory = N'ftp', @ftp_login = N'anonymous', @allow_subscription_copy = N'false', @add_to_active_directory = N'false', @dynamic_filters = N'false', @conflict_retention = 14, @keep_partition_changes = N'false', @allow_synctoalternate = N'false', @max_concurrent_merge = 0, @max_concurrent_dynamic_snapshots = 0, @use_partition_groups = N'false', @publication_compatibility_level = N'100RTM', @replicate_ddl = 1, @allow_subscriber_initiated_snapshot = N'false', @allow_web_synchronization = N'false', @allow_partition_realignment = N'true', @retention_period_unit = N'days', @conflict_logging = N'both', @automatic_reinitialization_policy = 0

exec sp_addpublication_snapshot @publication = N'UPE_MM2_Formular_Publication', @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 500, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0, @job_login = @job_loginVar, @job_password = @job_passwordVar, @publisher_security_mode = 1
exec sp_grant_publication_access @publication = N'UPE_MM2_Formular_Publication', @login = N'sa'
exec sp_grant_publication_access @publication = N'UPE_MM2_Formular_Publication', @login = @job_loginVar
exec sp_grant_publication_access @publication = N'UPE_MM2_Formular_Publication', @login = N'NT SERVICE\Winmgmt'
exec sp_grant_publication_access @publication = N'UPE_MM2_Formular_Publication', @login = N'NT SERVICE\SQLWriter'
exec sp_grant_publication_access @publication = N'UPE_MM2_Formular_Publication', @login = N'NT SERVICE\SQLSERVERAGENT'
exec sp_grant_publication_access @publication = N'UPE_MM2_Formular_Publication', @login = N'NT Service\MSSQLSERVER'
exec sp_grant_publication_access @publication = N'UPE_MM2_Formular_Publication', @login = N'distributor_admin'

-- Adding the merge articles
use [UPE_MM2_Formular]
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'AircraftBaseReplace', @source_owner = N'dbo', @source_object = N'AircraftBaseReplace', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'AttentionPointsInService', @source_owner = N'dbo', @source_object = N'AttentionPointsInService', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'BasementPlaces', @source_owner = N'dbo', @source_object = N'BasementPlaces', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F10_Common', @source_owner = N'dbo', @source_object = N'F10_Common', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F10_Operating', @source_owner = N'dbo', @source_object = N'F10_Operating', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F101', @source_owner = N'dbo', @source_object = N'F101', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F101_Operating', @source_owner = N'dbo', @source_object = N'F101_Operating', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F11', @source_owner = N'dbo', @source_object = N'F11', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F121', @source_owner = N'dbo', @source_object = N'F121', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F122', @source_owner = N'dbo', @source_object = N'F122', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F131', @source_owner = N'dbo', @source_object = N'F131', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F133', @source_owner = N'dbo', @source_object = N'F133', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F134', @source_owner = N'dbo', @source_object = N'F134', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F141', @source_owner = N'dbo', @source_object = N'F141', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F142', @source_owner = N'dbo', @source_object = N'F142', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F142_Operating', @source_owner = N'dbo', @source_object = N'F142_Operating', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F15', @source_owner = N'dbo', @source_object = N'F15', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F15_OperatinnRepair', @source_owner = N'dbo', @source_object = N'F15_OperatinnRepair', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F16_OperationNotes', @source_owner = N'dbo', @source_object = N'F16_OperationNotes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F2_TechData', @source_owner = N'dbo', @source_object = N'F2_TechData', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F3_IndividualFeature', @source_owner = N'dbo', @source_object = N'F3_IndividualFeature', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F41', @source_owner = N'dbo', @source_object = N'F41', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F41a', @source_owner = N'dbo', @source_object = N'F41a', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F42', @source_owner = N'dbo', @source_object = N'F42', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F43', @source_owner = N'dbo', @source_object = N'F43', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F43_ResourceOperating', @source_owner = N'dbo', @source_object = N'F43_ResourceOperating', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F52', @source_owner = N'dbo', @source_object = N'F52', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F62', @source_owner = N'dbo', @source_object = N'F62', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F62_ResourceValues', @source_owner = N'dbo', @source_object = N'F62_ResourceValues', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F71', @source_owner = N'dbo', @source_object = N'F71', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F8', @source_owner = N'dbo', @source_object = N'F8', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F91', @source_owner = N'dbo', @source_object = N'F91', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F92', @source_owner = N'dbo', @source_object = N'F92', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'F93', @source_owner = N'dbo', @source_object = N'F93', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'Formular', @source_owner = N'dbo', @source_object = N'Formular', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'Ids', @source_owner = N'dbo', @source_object = N'Ids', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'IZD_UNIT', @source_owner = N'dbo', @source_object = N'IZD_UNIT', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'OperatingAttributes', @source_owner = N'dbo', @source_object = N'OperatingAttributes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'OperatingClassificator', @source_owner = N'dbo', @source_object = N'OperatingClassificator', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'OperatingClassificator_Items', @source_owner = N'dbo', @source_object = N'OperatingClassificator_Items', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'Reports', @source_owner = N'dbo', @source_object = N'Reports', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Formular_Publication', @article = N'UserReadAttentionPoint', @source_owner = N'dbo', @source_object = N'UserReadAttentionPoint', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0

-- Adding the merge subscriptions
use [UPE_MM2_Formular]
exec sp_addmergesubscription @publication = N'UPE_MM2_Formular_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Formular', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Formular_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Formular', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Formular_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Formular', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Formular_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Formular', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Formular_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Formular', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Formular_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Formular', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Formular_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Formular', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Formular_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Formular', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Formular_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Formular', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Formular_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Formular', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0

-- Enabling the replication database
use master
exec sp_replicationdboption @dbname = N'UPE_MM2_ItemsAccount', @optname = N'merge publish', @value = N'true'

-- Adding the merge publication
use [UPE_MM2_ItemsAccount]
exec sp_addmergepublication @publication = N'UPE_MM2_ItemsAccount_Publication', @description = N'Merge publication of database ''UPE_MM2_ItemsAccount'' from Publisher ''UPE-SRV''.', @sync_mode = N'native', @retention = 14, @allow_push = N'true', @allow_pull = N'true', @allow_anonymous = N'true', @enabled_for_internet = N'false', @snapshot_in_defaultfolder = N'true', @compress_snapshot = N'false', @ftp_port = 21, @ftp_subdirectory = N'ftp', @ftp_login = N'anonymous', @allow_subscription_copy = N'false', @add_to_active_directory = N'false', @dynamic_filters = N'false', @conflict_retention = 14, @keep_partition_changes = N'false', @allow_synctoalternate = N'false', @max_concurrent_merge = 0, @max_concurrent_dynamic_snapshots = 0, @use_partition_groups = N'false', @publication_compatibility_level = N'100RTM', @replicate_ddl = 1, @allow_subscriber_initiated_snapshot = N'false', @allow_web_synchronization = N'false', @allow_partition_realignment = N'true', @retention_period_unit = N'days', @conflict_logging = N'both', @automatic_reinitialization_policy = 0

exec sp_addpublication_snapshot @publication = N'UPE_MM2_ItemsAccount_Publication', @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 500, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0, @job_login = @job_loginVar, @job_password = @job_passwordVar, @publisher_security_mode = 1
exec sp_grant_publication_access @publication = N'UPE_MM2_ItemsAccount_Publication', @login = N'sa'
exec sp_grant_publication_access @publication = N'UPE_MM2_ItemsAccount_Publication', @login = @job_loginVar
exec sp_grant_publication_access @publication = N'UPE_MM2_ItemsAccount_Publication', @login = N'NT SERVICE\Winmgmt'
exec sp_grant_publication_access @publication = N'UPE_MM2_ItemsAccount_Publication', @login = N'NT SERVICE\SQLWriter'
exec sp_grant_publication_access @publication = N'UPE_MM2_ItemsAccount_Publication', @login = N'NT SERVICE\SQLSERVERAGENT'
exec sp_grant_publication_access @publication = N'UPE_MM2_ItemsAccount_Publication', @login = N'NT Service\MSSQLSERVER'
exec sp_grant_publication_access @publication = N'UPE_MM2_ItemsAccount_Publication', @login = N'distributor_admin'

-- Adding the merge articles
use [UPE_MM2_ItemsAccount]
exec sp_addmergearticle @publication = N'UPE_MM2_ItemsAccount_Publication', @article = N'Account_Items', @source_owner = N'dbo', @source_object = N'Account_Items', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_ItemsAccount_Publication', @article = N'Account_SNOKPA', @source_owner = N'dbo', @source_object = N'Account_SNOKPA', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_ItemsAccount_Publication', @article = N'Account_SupportItems', @source_owner = N'dbo', @source_object = N'Account_SupportItems', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_ItemsAccount_Publication', @article = N'FAP_A50_1Account_Aircrafts', @source_owner = N'dbo', @source_object = N'FAP_A50_1Account_Aircrafts', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_ItemsAccount_Publication', @article = N'FAP_A50_2Account_Engines', @source_owner = N'dbo', @source_object = N'FAP_A50_2Account_Engines', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_ItemsAccount_Publication', @article = N'FAP_A50_3Account_DetachItems', @source_owner = N'dbo', @source_object = N'FAP_A50_3Account_DetachItems', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0

-- Adding the merge subscriptions
use [UPE_MM2_ItemsAccount]
exec sp_addmergesubscription @publication = N'UPE_MM2_ItemsAccount_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_ItemsAccount', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_ItemsAccount_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_ItemsAccount', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_ItemsAccount_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_ItemsAccount', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_ItemsAccount_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_ItemsAccount', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_ItemsAccount_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_ItemsAccount', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_ItemsAccount_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_ItemsAccount', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_ItemsAccount_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_ItemsAccount', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_ItemsAccount_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_ItemsAccount', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_ItemsAccount_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_ItemsAccount', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_ItemsAccount_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_ItemsAccount', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0

-- Enabling the replication database
use master
exec sp_replicationdboption @dbname = N'UPE_MM2_JPS', @optname = N'merge publish', @value = N'true'

-- Adding the merge publication
use [UPE_MM2_JPS]
exec sp_addmergepublication @publication = N'UPE_MM2_JPS_Publication', @description = N'Merge publication of database ''UPE_MM2_JPS'' from Publisher ''UPE-SRV''.', @sync_mode = N'native', @retention = 14, @allow_push = N'true', @allow_pull = N'true', @allow_anonymous = N'true', @enabled_for_internet = N'false', @snapshot_in_defaultfolder = N'true', @compress_snapshot = N'false', @ftp_port = 21, @ftp_subdirectory = N'ftp', @ftp_login = N'anonymous', @allow_subscription_copy = N'false', @add_to_active_directory = N'false', @dynamic_filters = N'false', @conflict_retention = 14, @keep_partition_changes = N'false', @allow_synctoalternate = N'false', @max_concurrent_merge = 0, @max_concurrent_dynamic_snapshots = 0, @use_partition_groups = N'false', @publication_compatibility_level = N'100RTM', @replicate_ddl = 1, @allow_subscriber_initiated_snapshot = N'false', @allow_web_synchronization = N'false', @allow_partition_realignment = N'true', @retention_period_unit = N'days', @conflict_logging = N'both', @automatic_reinitialization_policy = 0

exec sp_addpublication_snapshot @publication = N'UPE_MM2_JPS_Publication', @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 500, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0, @job_login = @job_loginVar, @job_password = @job_passwordVar, @publisher_security_mode = 1
exec sp_grant_publication_access @publication = N'UPE_MM2_JPS_Publication', @login = N'sa'
exec sp_grant_publication_access @publication = N'UPE_MM2_JPS_Publication', @login = @job_loginVar
exec sp_grant_publication_access @publication = N'UPE_MM2_JPS_Publication', @login = N'NT SERVICE\Winmgmt'
exec sp_grant_publication_access @publication = N'UPE_MM2_JPS_Publication', @login = N'NT SERVICE\SQLWriter'
exec sp_grant_publication_access @publication = N'UPE_MM2_JPS_Publication', @login = N'NT SERVICE\SQLSERVERAGENT'
exec sp_grant_publication_access @publication = N'UPE_MM2_JPS_Publication', @login = N'NT Service\MSSQLSERVER'
exec sp_grant_publication_access @publication = N'UPE_MM2_JPS_Publication', @login = N'distributor_admin'

-- Adding the merge articles
use [UPE_MM2_JPS]
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'Faults', @source_owner = N'dbo', @source_object = N'Faults', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'FlightPrepareControlList', @source_owner = N'dbo', @source_object = N'FlightPrepareControlList', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'ImportFaults', @source_owner = N'dbo', @source_object = N'ImportFaults', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'ImportFaultsDetail', @source_owner = N'dbo', @source_object = N'ImportFaultsDetail', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'ImportXLS', @source_owner = N'dbo', @source_object = N'ImportXLS', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'ImportXLSDetail', @source_owner = N'dbo', @source_object = N'ImportXLSDetail', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'JobTypes', @source_owner = N'dbo', @source_object = N'JobTypes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'JPS', @source_owner = N'dbo', @source_object = N'JPS', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'KUN', @source_owner = N'dbo', @source_object = N'KUN', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'KUN2', @source_owner = N'dbo', @source_object = N'KUN2', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'PilotRemarks', @source_owner = N'dbo', @source_object = N'PilotRemarks', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'PlanJobs', @source_owner = N'dbo', @source_object = N'PlanJobs', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'PrepareRoutes', @source_owner = N'dbo', @source_object = N'PrepareRoutes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'ReliabilityFormulas', @source_owner = N'dbo', @source_object = N'ReliabilityFormulas', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'SOK_ReportDetails', @source_owner = N'dbo', @source_object = N'SOK_ReportDetails', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'SOK_Reports', @source_owner = N'dbo', @source_object = N'SOK_Reports', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_JPS_Publication', @article = N'TypedPlanJobs', @source_owner = N'dbo', @source_object = N'TypedPlanJobs', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0

-- Adding the merge subscriptions
use [UPE_MM2_JPS]
exec sp_addmergesubscription @publication = N'UPE_MM2_JPS_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_JPS', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_JPS_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_JPS', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_JPS_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_JPS', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_JPS_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_JPS', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_JPS_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_JPS', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_JPS_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_JPS', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_JPS_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_JPS', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_JPS_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_JPS', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_JPS_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_JPS', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_JPS_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_JPS', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0

-- Enabling the replication database
use master
exec sp_replicationdboption @dbname = N'UPE_MM2_Organization', @optname = N'merge publish', @value = N'true'

-- Adding the merge publication
use [UPE_MM2_Organization]
exec sp_addmergepublication @publication = N'UPE_MM2_Organization_Publication', @description = N'Merge publication of database ''UPE_MM2_Organization'' from Publisher ''UPE-SRV''.', @sync_mode = N'native', @retention = 14, @allow_push = N'true', @allow_pull = N'true', @allow_anonymous = N'true', @enabled_for_internet = N'false', @snapshot_in_defaultfolder = N'true', @compress_snapshot = N'false', @ftp_port = 21, @ftp_subdirectory = N'ftp', @ftp_login = N'anonymous', @allow_subscription_copy = N'false', @add_to_active_directory = N'false', @dynamic_filters = N'false', @conflict_retention = 14, @keep_partition_changes = N'false', @allow_synctoalternate = N'false', @max_concurrent_merge = 0, @max_concurrent_dynamic_snapshots = 0, @use_partition_groups = N'false', @publication_compatibility_level = N'100RTM', @replicate_ddl = 1, @allow_subscriber_initiated_snapshot = N'false', @allow_web_synchronization = N'false', @allow_partition_realignment = N'true', @retention_period_unit = N'days', @conflict_logging = N'both', @automatic_reinitialization_policy = 0

exec sp_addpublication_snapshot @publication = N'UPE_MM2_Organization_Publication', @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 500, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0, @job_login = @job_loginVar, @job_password = @job_passwordVar, @publisher_security_mode = 1
exec sp_grant_publication_access @publication = N'UPE_MM2_Organization_Publication', @login = N'sa'
exec sp_grant_publication_access @publication = N'UPE_MM2_Organization_Publication', @login = @job_loginVar
exec sp_grant_publication_access @publication = N'UPE_MM2_Organization_Publication', @login = N'NT SERVICE\Winmgmt'
exec sp_grant_publication_access @publication = N'UPE_MM2_Organization_Publication', @login = N'NT SERVICE\SQLWriter'
exec sp_grant_publication_access @publication = N'UPE_MM2_Organization_Publication', @login = N'NT SERVICE\SQLSERVERAGENT'
exec sp_grant_publication_access @publication = N'UPE_MM2_Organization_Publication', @login = N'NT Service\MSSQLSERVER'
exec sp_grant_publication_access @publication = N'UPE_MM2_Organization_Publication', @login = N'distributor_admin'

-- Adding the merge articles
use [UPE_MM2_Organization]
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblAircraftDoljnost', @source_owner = N'dbo', @source_object = N'TblAircraftDoljnost', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblAircraftShtat', @source_owner = N'dbo', @source_object = N'TblAircraftShtat', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblChildren', @source_owner = N'dbo', @source_object = N'TblChildren', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblCollectionDraw', @source_owner = N'dbo', @source_object = N'TblCollectionDraw', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblDoljnost', @source_owner = N'dbo', @source_object = N'TblDoljnost', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblMillitaryRanks', @source_owner = N'dbo', @source_object = N'TblMillitaryRanks', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblOrganization', @source_owner = N'dbo', @source_object = N'TblOrganization', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblPerepodgotovka', @source_owner = N'dbo', @source_object = N'TblPerepodgotovka', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblPersonShtat', @source_owner = N'dbo', @source_object = N'TblPersonShtat', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblPhotos', @source_owner = N'dbo', @source_object = N'TblPhotos', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblPodgotovkaForShtat', @source_owner = N'dbo', @source_object = N'TblPodgotovkaForShtat', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'tblResponsible', @source_owner = N'dbo', @source_object = N'tblResponsible', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblRetrainings', @source_owner = N'dbo', @source_object = N'TblRetrainings', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblSchedules', @source_owner = N'dbo', @source_object = N'TblSchedules', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblSkills', @source_owner = N'dbo', @source_object = N'TblSkills', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblSpravOtrasl', @source_owner = N'dbo', @source_object = N'TblSpravOtrasl', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblStadyPlaces', @source_owner = N'dbo', @source_object = N'TblStadyPlaces', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblThemes', @source_owner = N'dbo', @source_object = N'TblThemes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblTypePerepodgotovka', @source_owner = N'dbo', @source_object = N'TblTypePerepodgotovka', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'tblUserEducation', @source_owner = N'dbo', @source_object = N'tblUserEducation', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblUsers', @source_owner = N'dbo', @source_object = N'TblUsers', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblVacations', @source_owner = N'dbo', @source_object = N'TblVacations', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Organization_Publication', @article = N'TblVUSs', @source_owner = N'dbo', @source_object = N'TblVUSs', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0

-- Adding the merge subscriptions
use [UPE_MM2_Organization]
exec sp_addmergesubscription @publication = N'UPE_MM2_Organization_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Organization', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Organization_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Organization', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Organization_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Organization', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Organization_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Organization', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Organization_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Organization', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Organization_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Organization', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Organization_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Organization', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Organization_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Organization', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Organization_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Organization', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Organization_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Organization', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0

-- Enabling the replication database
use master
exec sp_replicationdboption @dbname = N'UPE_MM2_Planning', @optname = N'merge publish', @value = N'true'

-- Adding the merge publication
use [UPE_MM2_Planning]
exec sp_addmergepublication @publication = N'UPE_MM2_Planning_Publication', @description = N'Merge publication of database ''UPE_MM2_Planning'' from Publisher ''UPE-SRV''.', @sync_mode = N'native', @retention = 14, @allow_push = N'true', @allow_pull = N'true', @allow_anonymous = N'true', @enabled_for_internet = N'false', @snapshot_in_defaultfolder = N'true', @compress_snapshot = N'false', @ftp_port = 21, @ftp_subdirectory = N'ftp', @ftp_login = N'anonymous', @allow_subscription_copy = N'false', @add_to_active_directory = N'false', @dynamic_filters = N'false', @conflict_retention = 14, @keep_partition_changes = N'false', @allow_synctoalternate = N'false', @max_concurrent_merge = 0, @max_concurrent_dynamic_snapshots = 0, @use_partition_groups = N'false', @publication_compatibility_level = N'100RTM', @replicate_ddl = 1, @allow_subscriber_initiated_snapshot = N'false', @allow_web_synchronization = N'false', @allow_partition_realignment = N'true', @retention_period_unit = N'days', @conflict_logging = N'both', @automatic_reinitialization_policy = 0

exec sp_addpublication_snapshot @publication = N'UPE_MM2_Planning_Publication', @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 500, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0, @job_login = @job_loginVar, @job_password = @job_passwordVar, @publisher_security_mode = 1
exec sp_grant_publication_access @publication = N'UPE_MM2_Planning_Publication', @login = N'sa'
exec sp_grant_publication_access @publication = N'UPE_MM2_Planning_Publication', @login = @job_loginVar
exec sp_grant_publication_access @publication = N'UPE_MM2_Planning_Publication', @login = N'NT SERVICE\Winmgmt'
exec sp_grant_publication_access @publication = N'UPE_MM2_Planning_Publication', @login = N'NT SERVICE\SQLWriter'
exec sp_grant_publication_access @publication = N'UPE_MM2_Planning_Publication', @login = N'NT SERVICE\SQLSERVERAGENT'
exec sp_grant_publication_access @publication = N'UPE_MM2_Planning_Publication', @login = N'NT Service\MSSQLSERVER'
exec sp_grant_publication_access @publication = N'UPE_MM2_Planning_Publication', @login = N'distributor_admin'

-- Adding the merge articles
use [UPE_MM2_Planning]
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'Aerodromes', @source_owner = N'dbo', @source_object = N'Aerodromes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'AvgFactors', @source_owner = N'dbo', @source_object = N'AvgFactors', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'Borts', @source_owner = N'dbo', @source_object = N'Borts', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'FactState', @source_owner = N'dbo', @source_object = N'FactState', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'Flights', @source_owner = N'dbo', @source_object = N'Flights', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'GeneralPlans', @source_owner = N'dbo', @source_object = N'GeneralPlans', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'Info', @source_owner = N'dbo', @source_object = N'Info', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'LastJobs', @source_owner = N'dbo', @source_object = N'LastJobs', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'Pilots', @source_owner = N'dbo', @source_object = N'Pilots', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'Planes', @source_owner = N'dbo', @source_object = N'Planes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'PlaneTypes', @source_owner = N'dbo', @source_object = N'PlaneTypes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'auto', @pub_identity_range = 10000, @identity_range = 1000, @threshold = 80, @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'Plans', @source_owner = N'dbo', @source_object = N'Plans', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'ProductState', @source_owner = N'dbo', @source_object = N'ProductState', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'States', @source_owner = N'dbo', @source_object = N'States', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'StatesByPlaneTypes', @source_owner = N'dbo', @source_object = N'StatesByPlaneTypes', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'Temp', @source_owner = N'dbo', @source_object = N'Temp', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'TmpGraph', @source_owner = N'dbo', @source_object = N'TmpGraph', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'TmpGraphP', @source_owner = N'dbo', @source_object = N'TmpGraphP', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Planning_Publication', @article = N'TmpRemain', @source_owner = N'dbo', @source_object = N'TmpRemain', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0

-- Adding the merge subscriptions
use [UPE_MM2_Planning]
exec sp_addmergesubscription @publication = N'UPE_MM2_Planning_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Planning', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Planning_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Planning', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Planning_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Planning', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Planning_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Planning', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Planning_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Planning', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Planning_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Planning', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Planning_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Planning', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Planning_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Planning', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Planning_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Planning', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Planning_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Planning', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0

-- Enabling the replication database
use master
exec sp_replicationdboption @dbname = N'UPE_MM2_Reglament2', @optname = N'merge publish', @value = N'true'

-- Adding the merge publication
use [UPE_MM2_Reglament2]
exec sp_addmergepublication @publication = N'UPE_MM2_Reglament2_Publication', @description = N'Merge publication of database ''UPE_MM2_Reglament2'' from Publisher ''UPE-SRV''.', @sync_mode = N'native', @retention = 14, @allow_push = N'true', @allow_pull = N'true', @allow_anonymous = N'true', @enabled_for_internet = N'false', @snapshot_in_defaultfolder = N'true', @compress_snapshot = N'false', @ftp_port = 21, @ftp_subdirectory = N'ftp', @ftp_login = N'anonymous', @allow_subscription_copy = N'false', @add_to_active_directory = N'false', @dynamic_filters = N'false', @conflict_retention = 14, @keep_partition_changes = N'false', @allow_synctoalternate = N'false', @max_concurrent_merge = 0, @max_concurrent_dynamic_snapshots = 0, @use_partition_groups = N'false', @publication_compatibility_level = N'100RTM', @replicate_ddl = 1, @allow_subscriber_initiated_snapshot = N'false', @allow_web_synchronization = N'false', @allow_partition_realignment = N'true', @retention_period_unit = N'days', @conflict_logging = N'both', @automatic_reinitialization_policy = 0

exec sp_addpublication_snapshot @publication = N'UPE_MM2_Reglament2_Publication', @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 500, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0, @job_login = @job_loginVar, @job_password = @job_passwordVar, @publisher_security_mode = 1
exec sp_grant_publication_access @publication = N'UPE_MM2_Reglament2_Publication', @login = N'sa'
exec sp_grant_publication_access @publication = N'UPE_MM2_Reglament2_Publication', @login = @job_loginVar
exec sp_grant_publication_access @publication = N'UPE_MM2_Reglament2_Publication', @login = N'NT SERVICE\Winmgmt'
exec sp_grant_publication_access @publication = N'UPE_MM2_Reglament2_Publication', @login = N'NT SERVICE\SQLWriter'
exec sp_grant_publication_access @publication = N'UPE_MM2_Reglament2_Publication', @login = N'NT SERVICE\SQLSERVERAGENT'
exec sp_grant_publication_access @publication = N'UPE_MM2_Reglament2_Publication', @login = N'NT Service\MSSQLSERVER'
exec sp_grant_publication_access @publication = N'UPE_MM2_Reglament2_Publication', @login = N'distributor_admin'

-- Adding the merge articles
use [UPE_MM2_Reglament2]
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'CA_TblTasks', @source_owner = N'dbo', @source_object = N'CA_TblTasks', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'CB_TblSubTasks', @source_owner = N'dbo', @source_object = N'CB_TblSubTasks', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'CC_TblSuccSubTasks', @source_owner = N'dbo', @source_object = N'CC_TblSuccSubTasks', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'CE_TblComments', @source_owner = N'dbo', @source_object = N'CE_TblComments', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'CG_TblSupportEq', @source_owner = N'dbo', @source_object = N'CG_TblSupportEq', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'CH_TblManuals', @source_owner = N'dbo', @source_object = N'CH_TblManuals', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'CI_TblAux', @source_owner = N'dbo', @source_object = N'CI_TblAux', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'CI_TblSpares', @source_owner = N'dbo', @source_object = N'CI_TblSpares', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'CK_TblPeopleFunctions', @source_owner = N'dbo', @source_object = N'CK_TblPeopleFunctions', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'CL_TblWarnings', @source_owner = N'dbo', @source_object = N'CL_TblWarnings', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'TblReglamentJobTypesMaintenance', @source_owner = N'dbo', @source_object = N'TblReglamentJobTypesMaintenance', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'TblReglamentLinks', @source_owner = N'dbo', @source_object = N'TblReglamentLinks', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'TblReglamentPunktLinksWithMaintenance', @source_owner = N'dbo', @source_object = N'TblReglamentPunktLinksWithMaintenance', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'TblReglaments', @source_owner = N'dbo', @source_object = N'TblReglaments', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0
exec sp_addmergearticle @publication = N'UPE_MM2_Reglament2_Publication', @article = N'TblReglamentStrings', @source_owner = N'dbo', @source_object = N'TblReglamentStrings', @type = N'table', @description = N'', @creation_script = N'', @pre_creation_cmd = N'drop', @schema_option = 0x000000010C034FD1, @identityrangemanagementoption = N'none', @destination_owner = N'dbo', @force_reinit_subscription = 1, @column_tracking = N'false', @subset_filterclause = N'', @vertical_partition = N'false', @verify_resolver_signature = 0, @allow_interactive_resolver = N'false', @fast_multicol_updateproc = N'true', @check_permissions = 0, @subscriber_upload_options = 0, @delete_tracking = N'true', @compensate_for_errors = N'false', @stream_blob_columns = N'true', @partition_options = 0

-- Adding the merge subscriptions
use [UPE_MM2_Reglament2]
exec sp_addmergesubscription @publication = N'UPE_MM2_Reglament2_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Reglament2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Reglament2_Publication', @subscriber = N'UPE-CLT1', @subscriber_db = N'UPE_MM2_Reglament2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Reglament2_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Reglament2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Reglament2_Publication', @subscriber = N'UPE-CLT2', @subscriber_db = N'UPE_MM2_Reglament2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Reglament2_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Reglament2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Reglament2_Publication', @subscriber = N'UPE-CLT3', @subscriber_db = N'UPE_MM2_Reglament2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Reglament2_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Reglament2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Reglament2_Publication', @subscriber = N'UPE-CLT4', @subscriber_db = N'UPE_MM2_Reglament2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
exec sp_addmergesubscription @publication = N'UPE_MM2_Reglament2_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Reglament2', @subscription_type = N'Push', @sync_type = N'Automatic', @subscriber_type = N'Global', @subscription_priority = 75, @description = N'', @use_interactive_resolver = N'False'
exec sp_addmergepushsubscription_agent @publication = N'UPE_MM2_Reglament2_Publication', @subscriber = N'UPE-RMO', @subscriber_db = N'UPE_MM2_Reglament2', @job_login = @job_loginVar, @job_password = @job_passwordVar, @subscriber_security_mode = 0, @subscriber_login = @subscriber_loginVar, @subscriber_password = @subscriber_passwordVar, @publisher_security_mode = 1, @frequency_type = 1, @frequency_interval = 0, @frequency_relative_interval = 0, @frequency_recurrence_factor = 0, @frequency_subday = 0, @frequency_subday_interval = 0, @active_start_time_of_day = 0, @active_end_time_of_day = 235959, @active_start_date = 0, @active_end_date = 0
